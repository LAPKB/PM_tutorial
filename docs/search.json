[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction",
    "section": "",
    "text": "These exercises will help you learn how to use Pmetrics for R. They are designed to be read in sequence, so start with the first one.\nWhen you work on a project, best practice is to use the following workflow:\nIf you have loaded Pmetrics already with library(Pmetrics), the command PMtree() will create a project folder with subfolders for you. To learn more about this function or any other in R, you can get help by typing ?function_name in the console.\n?PMtree\nWe assume you have some familiarity with R and possibly Quarto. If not, there are many good tutorials online."
  },
  {
    "objectID": "index.html#how-to-use-these-pages",
    "href": "index.html#how-to-use-these-pages",
    "title": "Introduction",
    "section": "How to use these pages",
    "text": "How to use these pages\nWe have designed these pages with the idea that you can copy and paste the code chunks into your own scripts or Quarto documents to see how they work. You can hover over the code chunks to see a copy icon. Click that to copy the code to your clipboard so you can paste it into your own script or document. Alternatively, you can click the “Copy all code” button at the top right of every page to copy all the code chunks on that page to your clipboard.\nNote: In many cases, we do not evaluate the code chunks because the ouput is too long, so you will need to run them in your own script or document.\n\n# Hover over the code chunk to see the copy icon."
  },
  {
    "objectID": "index.html#scripting",
    "href": "index.html#scripting",
    "title": "Introduction",
    "section": "Scripting",
    "text": "Scripting\nYou can use either an R script or a Quarto document to paste code from these pages or to write your own code. R scripts have the advantage of being simple and easy to use. Quarto documents have the advantage of being able to combine code with formatted text, images, links, etc. You can use either method to work with Pmetrics. Choose the one that works best for you.\n\nR script\n\nCreate a new script with File -&gt; New File -&gt; R Script (Rstudio) or R File (Positron).\nSave the script in your project directory with a name like “Learn.R”.\nYou can then copy and paste code chunks from these pages into your script and run them line by line or all at once.\nIt is useful to annotate your code with comments like the one above so you can remember what you did later.\n\nHere’s a toy example of an R script.\n\n# This is a comment in R. It starts with a # symbol.\n# Anything other than a comment should be R code.\na &lt;- 1 + 1\nprint(a) # This will print the value of a to the console.\n\n\n\nQuarto document\n\nCreate a new document with File -&gt; New File -&gt; Quarto Document (Rstudio/Positron).\nUse markdown to add headings, links, images, etc.\nInsert R chunks to paste copied code or write your own.\nExecute code from the chunks.\nRender the document to create a nicely formatted output in HTML, PDF, or Word format.\nSee Quarto documentation for more information.\n\nHere’s a toy example of a Quarto document. It mixes text formatted in markdown and R code chunks.\n---\ntitle: \"My Project\"\nformat: html\n---\n\n## Introduction\nThis is my first Quarto document. Below is some R code.\n\n```{r}\n# this is an R code chunk\nb &lt;- 2 + 2\nprint(b)\n```\n\nYou can see that the value of b is printed above.\n\nWhen rendered, the above will look like this:"
  },
  {
    "objectID": "index.html#my-project",
    "href": "index.html#my-project",
    "title": "Introduction",
    "section": "My Project",
    "text": "My Project\n\nIntroduction\nThis is my first Quarto document. Below is some R code.\n\n# this is an R code chunk\nb &lt;- 2 + 2\nprint(b)\n\n[1] 4\n\n\nYou can see that the value of b is printed above."
  },
  {
    "objectID": "examine.html",
    "href": "examine.html",
    "title": "",
    "section": "",
    "text": "Recall that in the previous exercises, we loaded our run results with the following.\nrun1 &lt;- PM_load(1, path = \"../Examples/Runs\")\nrun1 is now a PM_result R6 object that contains all the results from the NPAG run. Let’s dig into it in more detail."
  },
  {
    "objectID": "examine.html#examine-the-results",
    "href": "examine.html#examine-the-results",
    "title": "",
    "section": "Examine the results",
    "text": "Examine the results\n\nData\n\nData plots\nYou can plot the original data using R6 with various options. Type ?plot.PM_data in the R console for help.\n\nrun1$data$plot() \n\n\n\n\n\n\n\nHere’s some nice grouping and coloring. If you use grouping, provide names in group_names and colors/symbols for each group as arguments to marker. Colors of lines will be set to the same as for marker to avoid a mess of colors.\n\nrun1$data$plot(group = \"gender\", group_names = c(\"Female\", \"Male\"), \n  marker = list(color = c(\"red\",\"blue\"), symbol = c(\"circle\",\"triangle-up\"))) \n\n\n\n\n\n\n\nThe next one splits the data by subject but will not render easily in this document. You can interact with it in your own script or Quarto document.\n\nrun1$data$plot(overlay = FALSE, xlim = c(119, 145))\n\nThe following are the older S3 method with plot(...) for the first two examples. You can use R6 or S3 for any Pmetrics object. We will focus on R6 as the more modern way.\n\nplot(run1$data)\n\n\n\nData summaries\nHere’s a summary of the original data file; ?summary.PM_data for help.\n\nrun1$data$summary()\n\n\n\n\nObserved vs. Predicted (OP)\n\nOP plots\nYou can plot observed vs. predicted data. Type ?plot.PMop in the R console for help or check out plot.PM_op.\n\nrun1$op$plot() \n\n\n\n\n\n\n\nBelow, you can see how to change the prediction type, regression line and color, and plotting symbol and color. Most plots in Pmetrics have marker and line list arguments to customize the appearance of the plotting symbols and lines.\n\nrun1$op$plot(pred.type = \"pop\")\nrun1$op$plot(line = list(lm = FALSE, loess = list(color = \"red\")), marker = list(symbol = 3, color = \"green\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\nOP summaries\nGet a summary with bias and imprecision of the population predictions; ?summary.PM_op in the console or summary.PM_op for more information. The default pred.type is “post”, which are the predictions based on the full Bayesian posterior distribution of parameter values for an individual. The predictions are the weighted mean or median (controlled by the icen argument in all Pmetrics functions) of the predictions from each support point in the individual’s Bayesian posterior, joint probability parameter distribution, i.e. the support points in the posterior. Here we will look at the population predictions based on the means of the parameter values.\n\nrun1$op$summary(pred.type = \"pop\", icen = \"mean\")\n\n\n\n\n\nSince neither “pop” nor “mean” are the defaults, we have to specify them. We can also use the S3 method for the same summary below.\n\nsummary(run1$op, pred.type = \"pop\", icen = \"mean\") # S3 method\n\nAs with any object in Pmetrics, the PM_op R6 object has fields and methods. Fields contain data and methods are functions that act on the data. All fields and methods are accessed with $ added to the name of the object. For example, in a PM_op object and most other Pmetrics objects, the raw data can be accessed via the $data field.\n\nrun1$op$data\n\nHaving the raw data provides a data frame compatible with any R function, particularly those from Tidyverse (see https://www.tidyverse.org/), including piping (%&gt;%). If you’re not familiar with the pipe operator, see this article. We strongly recommend Tidvyerse for data manipulation and visualization in R, and Pmetrics works well with it. See R for Data Science for more information.\nThis allows pre-processing in ways more flexible than the default plot method.\n\nlibrary(tidyverse)\nrun1$op$data %&gt;% plot()\nrun1$op$data %&gt;%\n  filter(pred &gt; 5) %&gt;%\n  filter(pred &lt; 10) %&gt;%\n  summary()\n\nSee a header with the first 10 rows of the op object:\n\nhead(run1$op$data, 10)\n\n\n\n\nFinal population joint density\n\nFinal plots\nPlot the final population joint density. Type ?plot.PM_final in the R console for help.\n\nrun1$final$plot()\n\n# alternate methods with same result\nrun1$final$data %&gt;% plot() # tidyverse style\nplot(run1$final) # S3 method\nplot(run1$final$data) # S3 method\n\n\n\n\n\n\n\nYou can add a kernel density curve.\n\nrun1$final$plot(line = list(color = \"red\"))\n\n\n\n\n\n\n\nIt is possible to make a bivariate plot. Plotting formulae in R are of the form y~x\n\nrun1$final$plot(ke ~ v,\n  marker = list(color = \"red\", symbol = \"diamond\"))\n\n\n\n\n\n\n\n\n\nFinal summaries\nSee a summary with confidence intervals around the medians and the Median Absolute Weighted Difference (MAWD); ?summary.PM_final for help and further explanation.\n\nrun1$final$summary()\n\nThe original final object can be accessed with the $data field.\n\nrun1$final$data\nnames(run1$final$data)\n\nSee the population points:\n\nrun1$final$popPoints\n\n# A tibble: 19 × 5\n      ka     ke     v   tlag1   prob\n   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;\n 1 0.899 0.0340  74.4 2.01    0.101 \n 2 0.898 0.0433 108.  2.09    0.0500\n 3 0.897 0.0608  32.5 3.14    0.0500\n 4 0.899 0.0564 120.  0.678   0.0502\n 5 0.363 0.0749  68.4 0.869   0.0500\n 6 0.805 0.0755  60.8 1.09    0.0500\n 7 0.899 0.0278  63.7 1.75    0.0506\n 8 0.690 0.0371  85.1 0.644   0.0504\n 9 0.102 0.0642 119.  0.00843 0.0498\n10 0.717 0.0590  64.8 0.821   0.0497\n11 0.364 0.0278  58.9 0.458   0.0494\n12 0.549 0.0450 114.  0.316   0.0521\n13 0.694 0.0456  97.9 0.853   0.0497\n14 0.748 0.0291  95.9 1.39    0.0502\n15 0.866 0.0331  74.4 1.11    0.0484\n16 0.747 0.0397 120.  0.00315 0.0485\n17 0.437 0.0698  43.2 3.99    0.0568\n18 0.727 0.0578  53.3 3.04    0.0149\n19 0.725 0.0578  53.3 3.04    0.0783\n\n\nOr drill down one more level into the raw data. The $final$popPoints field above pulls its information from the $final$data$popPoints field below, but is provided as a simpler way to access the population points.\n\nrun1$final$data$popPoints\n\nSee the population mean parameter values:\n\nrun1$final$popMean\n\n# A tibble: 1 × 4\n     ka     ke     v tlag1\n  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.694 0.0487  79.0  1.48\n\n\n\n\n\nCycle information\n\nCycle plots\nPlot cycle information; type ?plot.PM_cycle in the R console for help.\n\nrun1$cycle$plot()\n\n\n\n\n\n\n\n\n\nCycle summaries\nSummarize the cycle information; ?summary.PM_cycle for help.\n\nrun1$cycle$summary()\n\n# alternatives\nrun1$cycle$data %&gt;% summary() # tidyverse style\nsummary(run1$cycle) # S3 method\nsummary(run1$cycle$data) # S3 method\n\n\n\n\n\n\n── Cycle Summary ──\n\n\n\n\n\nCycle number: 100 of 100\n\n\nStatus: Maximum cycles reached\n\n\nLog-likelihood: 440.985\n\n\nAIC:: 448.985\n\n\nBIC: 452.968\n\n\nOuteq 1: Gamma = 2.39\n\n\n\n\n\n── Normalized parameter values: \n\n\n# A tibble: 3 × 6\n  cycle    ka    ke     v tlag1 stat  \n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; \n1   100  1.14 0.978 0.975 0.931 mean  \n2   100  1.10 0.622 1.83  1.41  sd    \n3   100  1.13 1     0.92  0.865 median\n\n\n\n\n\nCovariate information\n\nCovariate plots\nPlot covariate information; type ?plot.PM_cov in the R console for help. Recall that plotting formulae in R are of the form y~x.\n\nrun1$cov$plot(v ~ wt)\n\n\n\n\n\n\n\nYou can also use the raw data in the $data field to make plots with other R functions, including those from Tidyverse. Here we will filter the data for age &gt; 25 and then plot volume vs. weight.\n\nrun1$cov$data %&gt;%\n  filter(age &gt; 25) %&gt;%\n  plot(v ~ wt)\n\nChange the formatting of the plot with the line and marker list arguments.\n\nrun1$cov$plot(ke ~ age, line = list(loess = FALSE, lm = list(color = \"red\")),\n               marker = list(symbol = 3))\n\n\n\n\n\n\n\nAnother plot with mean Bayesian posterior parameter and covariate values…remember the icen argument?\n\nrun1$cov$plot(v ~ wt, icen = \"mean\")\n\n\n\n\n\n\n\nWhen time is the x variable, the y variable is aggregated by subject. In R plot formulae, calculations on the fly can be included using the I() function.\n\nrun1$cov$plot(I(v * wt) ~ time)\n\n\n\n\n\n\n\nThe above plots the product of volume and weight vs. time for each subject.\n\n\nCovariate summaries\nJust as you have the option to plot by mean covariate and posterior parameter values, you can summarize with means; ?summary.PM_cov for help.\n\nrun1$cov$summary(icen = \"mean\")\n\n# A tibble: 20 × 11\n      id    ka     ke     v  tlag1 africa   age gender height    wt icen \n   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;\n 1     1 0.370 0.0278  59.0 0.473       1    21      1    160  46.7 mean \n 2     2 0.739 0.0399 120.  0.0155      1    30      1    174  66.5 mean \n 3     3 0.898 0.0433 108.  2.09        1    24      0    164  46.7 mean \n 4     4 0.899 0.0564 120.  0.678       1    25      1    165  50.8 mean \n 5     5 0.104 0.0642 119.  0.0105      1    22      1    181  65.8 mean \n 6     6 0.898 0.0340  74.4 2.01        1    23      1    177  65   mean \n 7     7 0.706 0.0586  52.7 3.11        1    27      0    161  51.7 mean \n 8     8 0.898 0.0340  74.4 2.01        1    22      1    163  51.2 mean \n 9     9 0.692 0.0456  98.1 0.845       1    23      1    174  55   mean \n10    10 0.717 0.0590  64.9 0.821       1    32      1    163  52.1 mean \n11    11 0.363 0.0749  68.4 0.869       1    34      1    165  56.5 mean \n12    12 0.749 0.0292  95.5 1.39        1    54      0    160  47.9 mean \n13    13 0.452 0.0692  43.7 3.94        1    24      1    180  60.5 mean \n14    14 0.552 0.0449 114.  0.315       1    26      1    174  59.2 mean \n15    15 0.864 0.0330  74.8 1.13        1    19      0    150  43   mean \n16    16 0.690 0.0371  85.2 0.646       1    25      1    173  64.4 mean \n17    17 0.805 0.0755  60.8 1.09        1    23      1    170  54.8 mean \n18    18 0.899 0.0278  63.7 1.74        1    20      0    164  44.3 mean \n19    19 0.897 0.0608  32.5 3.14        1    36      1    168  50   mean \n20    20 0.691 0.0592  52.1 3.16        1    31      1    170  59   mean \n\n\nThe run1$cov object looks like a data frame, but is really an R6 PM_cov object whose $print() method returns a data frame. You can access the raw data with the $data field, which is truly a data frame.\n\nrun1$cov$data[, 1:3] # for example\nrun1$cov$data %&gt;% filter(gender == 1) %&gt;% summary() # using Tidyverse\n\nThis returns a data frame with the means of the individual’s covariates over the observation period and the mean of the Bayesian posterior parameter values.\nWhen trying to find covariate-parameter relationships, it is convenient to examine at all possible covariate-parameter relationships by multiple linear regression with forward and backward elimination - type ?PM_step in the R console for help or see PM_step.\n\nrun1$step()\n\n       age gender height    wt\nka      NA     NA     NA    NA\nke      NA  0.047  0.076 0.105\nv       NA     NA  0.181 0.116\ntlag1   NA  0.162     NA    NA\nafrica  NA     NA     NA    NA\n\n\n…or on the cov object directly.\n\nrun1$cov$step()\n\nicen works here too.\n\nrun1$step(icen = \"mean\")\n\nIf you wish to see P values for forward elimination only:\n\nrun1$step(direction = \"forward\")\n\n         age gender height    wt\nka     0.841  0.519  0.257 0.267\nke     0.920  0.127  0.236 0.281\nv      0.784  0.694  0.084 0.149\ntlag1  0.684  0.287  0.238 0.624\nafrica    NA     NA     NA    NA"
  }
]